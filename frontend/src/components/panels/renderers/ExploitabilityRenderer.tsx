import type { AnalysisSectionResult } from '../../../types';
import { isExploitabilityResult } from '../../../types';

export interface ExploitabilityRendererProps {
  result: AnalysisSectionResult;
}

// Determine quality badge color
function getQualityClass(quality: string): string {
  const q = quality.toLowerCase();
  if (q.includes('near-optimal') || q.includes('essentially nash')) return 'good';
  if (q.includes('very good') || q.includes('good')) return 'moderate';
  return 'poor';
}

export function ExploitabilityRenderer({ result }: ExploitabilityRendererProps) {
  const details = isExploitabilityResult(result?.details) ? result.details : null;

  if (!details) {
    return (
      <div className="analysis-result-text">
        {result?.summary}
      </div>
    );
  }

  return (
    <div className="exploitability-result">
      <div className="scalar-result">
        <div className="value-display">
          <span className="value">{details.nash_conv.toFixed(6)}</span>
          <span className="label">Nash Conv</span>
        </div>
        <div className={`quality-indicator ${getQualityClass(details.quality)}`}>
          {details.quality}
        </div>
      </div>

      <p className="policy-info">Policy: {details.policy_type}</p>
    </div>
  );
}
